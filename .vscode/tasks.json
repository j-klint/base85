{
"tasks": [
    {
        "label": "C/C++: Compile!",
        "dependsOn": "Tee hakemisto",
        "dependsOrder": "sequence",

        "windows": {
            "type": "cppbuild",
            "label": "C/C++: cl.exe käännä ohjelma",
            "command": "cl.exe",
            "args": [
                "/permissive-",
                "/Qvec-report:1",
                "/W4",
                "/std:c++17",
                "/EHsc", // enable exceptions?
                "/nologo",
                "/Fe${workspaceFolder}\\built\\base85.exe",
                "${workspaceFolder}\\*.cpp",
                // "/favor:INTEL64",
                "/arch:AVX2",
                "/GR-", // disable C++ RTTI
                //"/O1",  // optimize for size
                "/O2",  // optimize for speed
                "/GL",  // "Whole program optimization"
                "/Gw",  // Optimize Global Data
                //"/MT",  // link with LIBCMT.LIB
                "/MD",  // link with MSVCRT.LIB
                "/DNDEBUG", // #define NDEBUG, ks. c_cpp_properties.json
                // "/MTd", //MTd link with LIBCMTD.LIB debug lib
                // "/Zi",  //enable debug
                "/link",
                // "/DEBUG",
                "/LTCG", // Link-time code generation /GL'n kanssa
            ],
            "options": { "cwd": "${workspaceFolder}\\built" },
            "problemMatcher": [ "$msCompile" ]
        },

        "linux": {
            "label": "C/C++: g++ compile",
            "type": "shell", // "cppbuild":issa ei globaus toimi
            "options": {
                "cwd": "${workspaceFolder}/built",
                "shell": "/bin/bash"
             },
            "problemMatcher": [ "$gcc" ],
            "command": "g++",
            "args": [
                "-std=c++17",
                "-fno-rtti",
                "-O3",
                "-D NDEBUG",
                "-Wall",
                "-Wextra",
                "-Wpedantic",
                "-o",
                "./base85",
                "${workspaceFolder}/*.cpp"
            ]
        },

        "group": {
            "kind": "build",
            "isDefault": true
        },
        "detail": "Task generated by Debugger."
    },
    
    {
        "label": "Tee hakemisto",
        "windows": {
            "group": "build",
            "type": "shell",
            "options": { "shell": { "executable": "powershell" } },
            "command": "New-Item",
            "args": [
                "-Force",
                "-ItemType",
                "Directory",
                "${workspaceFolder}\\built"
            ]
        },
        "linux": {
            "group": "build",
            "type": "process",
            "options": { "shell": { "executable": "/bin/bash" } },
            "command": "mkdir",
            "args": [
                "-p",
                "${workspaceFolder}/built"
            ]
        },
        "detail": "Makes the built directory in case it doesn't exist yet."
    }
],
"version": "2.0.0"
}
